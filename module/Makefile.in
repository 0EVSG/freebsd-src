subdir-m += spl
subdir-m += splat

INSTALL=/usr/bin/install

modules:
	$(MAKE) -C @LINUX_OBJ@ SUBDIRS=`pwd` @KERNELMAKE_PARAMS@ $@

clean:
	$(MAKE) -C @LINUX_OBJ@ SUBDIRS=`pwd` @KERNELMAKE_PARAMS@ $@
	if [ -f @LINUX_SYMBOLS@ ]; then $(RM) @LINUX_SYMBOLS@; fi
	if [ -f Module.markers ]; then $(RM) Module.markers; fi

modules_install:
	$(MAKE) -C @LINUX_OBJ@ SUBDIRS=`pwd` \
		INSTALL_MOD_PATH=$(DESTDIR) \
		INSTALL_MOD_DIR=addon/spl $@
	find ${DESTDIR}/lib/modules/ -name 'modules.*' | xargs ${RM}

distdir:
	list='$(subdir-m)'; for subdir in $$list; do \
		(find $$subdir -name '*.c' -o -name '*.h' | \
		 xargs /bin/cp -t $$distdir/$$subdir); \
	done

distclean maintainer-clean: clean
install: modules_install
all: modules
check:
