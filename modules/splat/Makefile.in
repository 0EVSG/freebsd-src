# Makefile.in for splat kernel module

MODULES := splat
DISTFILES = Makefile.in \
            splat-kmem.c splat-random.c splat-taskq.c \
            splat-time.c splat-condvar.c  splat-mutex.c \
            splat-rwlock.c  splat-thread.c \
            splat-ctl.c splat-internal.h

CPPFLAGS += @KERNELCPPFLAGS@

# Solaris porting layer aggressive tests
obj-m := splat.o

splat-objs += splat-ctl.o
splat-objs += splat-kmem.o
splat-objs += splat-taskq.o
splat-objs += splat-random.o
splat-objs += splat-mutex.o
splat-objs += splat-condvar.o
splat-objs += splat-thread.o
splat-objs += splat-rwlock.o
splat-objs += splat-time.o
splat-objs += splat-vnode.o
splat-objs += splat-kobj.o

splatmodule := splat.ko
splatmoduledir := @kmoduledir@/kernel/lib/

install:
	mkdir -p $(DESTDIR)$(splatmoduledir)
	$(INSTALL) -m 644 $(splatmodule) $(DESTDIR)$(splatmoduledir)/$(splatmodule)
	-/sbin/depmod -a

uninstall:
	rm -f $(DESTDIR)$(splatmoduledir)/$(splatmodule)
	-/sbin/depmod -a

clean:
	-rm -f $(splmodule) *.o .*.cmd *.mod.c *.ko *.s */*.o

distclean: clean
	rm -f Makefile
	rm -rf .tmp_versions

maintainer-clean: distclean

distdir: $(DISTFILES)
	cp -p $(DISTFILES) $(distdir)
